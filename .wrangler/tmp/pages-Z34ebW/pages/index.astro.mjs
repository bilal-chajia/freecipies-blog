if (typeof MessageChannel === 'undefined') {
  function MessagePort() {
    this.onmessage = null;
    this._target = null;
  }
  MessagePort.prototype.postMessage = function (data) {
    var handler = this._target && this._target.onmessage;
    if (typeof handler === 'function') {
      handler({ data: data });
    }
  };
  function MessageChannelPolyfill() {
    this.port1 = new MessagePort();
    this.port2 = new MessagePort();
    this.port1._target = this.port2;
    this.port2._target = this.port1;
  }
  globalThis.MessageChannel = MessageChannelPolyfill;
}

import { c as createAstro, a as createComponent, r as renderTemplate, h as defineScriptVars, m as maybeRenderHead, b as addAttribute, d as renderComponent, f as renderScript } from '../chunks/astro/server_B79ahsw9.mjs';
import { $ as $$Layout } from '../chunks/Layout_DDkk2Mp3.mjs';
import '../chunks/pinterest.schema_eG5oHE2g.mjs';
import { c as getArticles } from '../chunks/articles.service_DgNeye45.mjs';
import { e as getCategories } from '../chunks/categories.service_BzGDlPlq.mjs';
import { e as extractImage, g as getImageSrcSet, a as hydrateArticle, f as hydrateCategory } from '../chunks/hydration_PCOoIFzn.mjs';
/* empty css                                 */
export { renderers } from '../renderers.mjs';

var __freeze$1 = Object.freeze;
var __defProp$1 = Object.defineProperty;
var __template$1 = (cooked, raw) => __freeze$1(__defProp$1(cooked, "raw", { value: __freeze$1(cooked.slice()) }));
var _a$1;
const $$Astro$1 = createAstro("https://localhost:4321");
const $$StoriesBar = createComponent(async ($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro$1, $$props, $$slots);
  Astro2.self = $$StoriesBar;
  const { env } = Astro2.locals.runtime;
  const oneDayAgo = /* @__PURE__ */ new Date();
  oneDayAgo.setHours(oneDayAgo.getHours() - 24);
  let { items: stories } = await getArticles(env.DB, {
    isOnline: true,
    limit: 15
  });
  if (stories.length === 0) {
    const { items: fallback } = await getArticles(env.DB, { limit: 12 });
    stories = fallback;
  }
  stories = stories.sort((a, b) => (b.viewCount || 0) - (a.viewCount || 0));
  const storiesWithPages = stories.map((story) => {
    const preview = extractImage(story.imagesJson, "thumbnail", 120);
    const cover = extractImage(story.imagesJson, "cover", 1200);
    preview.imageUrl ? preview : cover;
    const storyImage = cover.imageUrl || preview.imageUrl || story.imageUrl;
    return {
      ...story,
      storyImage,
      storyPreview: {
        imageUrl: preview.imageUrl || story.imageUrl,
        imageAlt: preview.imageAlt || story.headline,
        imageWidth: preview.imageWidth || 80,
        imageHeight: preview.imageHeight || 80,
        srcSet: getImageSrcSet(story.imagesJson, "thumbnail")
      },
      storyPages: [
        {
          imageUrl: storyImage,
          title: story.headline,
          text: story.shortDescription || story.tldr || ""
        },
        ...storyImage ? [
          {
            imageUrl: storyImage,
            title: "Swipe to continue",
            text: "Tap right to see more"
          }
        ] : [],
        {
          imageUrl: storyImage,
          title: story.headline,
          text: "Ready to cook?"
        }
      ]
    };
  });
  return renderTemplate(_a$1 || (_a$1 = __template$1(["", "<script>(function(){", '\n  // Pass data to client-side safely without bloating DOM\n  window.STORIES_DATA = storiesData;\n})();<\/script><script>\n  // Handle story item clicks - using is:inline to ensure it runs\n  (function () {\n    console.log("StoriesBar script initializing");\n\n    function initStoryClicks() {\n      const storyItems = document.querySelectorAll(".story-item");\n      console.log("Found story items:", storyItems.length);\n\n      storyItems.forEach((item) => {\n        item.addEventListener("click", (e) => {\n          e.preventDefault();\n          e.stopPropagation();\n\n          const index = parseInt(item.getAttribute("data-story-index") || "0");\n          console.log("Story item clicked:", index);\n\n          const route = item.getAttribute("data-story-route");\n          const slug = item.getAttribute("data-story-slug");\n          const headline = item.getAttribute("data-story-headline");\n\n          // Get pages from global object instead of parsing DOM attribute\n          const storyWithPages =\n            window.STORIES_DATA && window.STORIES_DATA[index];\n          const pages = storyWithPages ? storyWithPages.storyPages : [];\n\n          console.log("Story data from global:", {\n            route,\n            slug,\n            headline,\n            pagesFound: pages.length > 0,\n          });\n\n          if (pages.length > 0) {\n            try {\n              const storyData = {\n                route: route,\n                slug: slug,\n                headline: headline,\n              };\n\n              // Check if openWebStory exists\n              if (typeof window.openWebStory === "function") {\n                console.log("Calling openWebStory");\n                window.openWebStory(storyData, pages);\n              } else {\n                console.error("openWebStory function not found on window");\n              }\n            } catch (err) {\n              console.error("Failed to open story:", err);\n            }\n          } else {\n            console.error("No story pages data found");\n          }\n        });\n      });\n    }\n\n    // Mouse drag scroll for desktop\n    function initDragScroll() {\n      const slider = document.querySelector(".stories-scroll");\n      if (!slider) return;\n\n      let isDown = false;\n      let startX;\n      let scrollLeft;\n\n      slider.addEventListener("mousedown", (e) => {\n        // Ignore if clicking on a story item\n        if (e.target.closest(".story-item")) return;\n        isDown = true;\n        slider.style.cursor = "grabbing";\n        slider.style.scrollBehavior = "auto"; // Disable smooth scroll for instant drag\n        startX = e.pageX - slider.offsetLeft;\n        scrollLeft = slider.scrollLeft;\n      });\n\n      slider.addEventListener("mouseleave", () => {\n        isDown = false;\n        slider.style.cursor = "grab";\n        slider.style.scrollBehavior = "smooth"; // Re-enable smooth scroll\n      });\n\n      slider.addEventListener("mouseup", () => {\n        isDown = false;\n        slider.style.cursor = "grab";\n        slider.style.scrollBehavior = "smooth"; // Re-enable smooth scroll\n      });\n\n      slider.addEventListener("mousemove", (e) => {\n        if (!isDown) return;\n        e.preventDefault();\n        const x = e.pageX - slider.offsetLeft;\n        const walk = (x - startX) * 2; // Scroll speed multiplier\n        slider.scrollLeft = scrollLeft - walk;\n      });\n\n      // Set initial cursor\n      slider.style.cursor = "grab";\n    }\n\n    // Initialize when DOM is ready\n    if (document.readyState === "loading") {\n      document.addEventListener("DOMContentLoaded", () => {\n        initStoryClicks();\n        initDragScroll();\n      });\n    } else {\n      initStoryClicks();\n      initDragScroll();\n    }\n  })();\n<\/script>'])), stories.length > 0 && renderTemplate`${maybeRenderHead()}<section class="stories-section" data-astro-cid-obl65slz><div class="stories-container" data-astro-cid-obl65slz><div class="stories-scroll" data-astro-cid-obl65slz>${storiesWithPages.map((story, idx) => renderTemplate`<button type="button" class="story-item"${addAttribute(idx, "data-story-index")}${addAttribute(story.slug, "data-story-slug")}${addAttribute(story.route || `/recipes/${story.slug}`, "data-story-route")}${addAttribute(story.headline, "data-story-headline")} data-astro-cid-obl65slz><div class="story-ring" data-astro-cid-obl65slz><div class="story-image-wrapper" data-astro-cid-obl65slz>${story.storyPreview?.imageUrl ? renderTemplate`<img${addAttribute(story.storyPreview.imageUrl, "src")}${addAttribute(story.storyPreview.imageAlt || story.headline, "alt")}${addAttribute(story.storyPreview.imageWidth || 80, "width")}${addAttribute(story.storyPreview.imageHeight || 80, "height")}${addAttribute(story.storyPreview.srcSet || void 0, "srcset")}${addAttribute(story.storyPreview.srcSet ? "80px" : void 0, "sizes")} loading="lazy" data-astro-cid-obl65slz>` : renderTemplate`<div class="story-placeholder" data-astro-cid-obl65slz>${story.headline.charAt(0)}</div>`}</div></div><span class="story-title" data-astro-cid-obl65slz>${story.headline}</span></button>`)}</div></div></section>`, defineScriptVars({ storiesData: storiesWithPages }));
}, "C:/Users/Poste/Desktop/SaaS Astro/freecipies-blog/src/components/StoriesBar.astro", void 0);

var __freeze = Object.freeze;
var __defProp = Object.defineProperty;
var __template = (cooked, raw) => __freeze(__defProp(cooked, "raw", { value: __freeze(raw || cooked.slice()) }));
var _a;
const $$WebStoryViewer = createComponent(($$result, $$props, $$slots) => {
  return renderTemplate(_a || (_a = __template(["", '<div id="web-story-viewer" class="story-viewer" data-astro-cid-vbs6sfrm> <div class="story-container" data-astro-cid-vbs6sfrm> <!-- Close button --> <button class="story-close" aria-label="Close story" data-astro-cid-vbs6sfrm> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-vbs6sfrm> <line x1="18" y1="6" x2="6" y2="18" data-astro-cid-vbs6sfrm></line> <line x1="6" y1="6" x2="18" y2="18" data-astro-cid-vbs6sfrm></line> </svg> </button> <!-- Story content container --> <div class="story-content" data-story-content data-astro-cid-vbs6sfrm> <!-- Pages will be injected here by client script --> </div> <!-- Navigation Buttons --> <button class="story-nav-btn story-nav-prev" aria-label="Previous" data-story-prev data-astro-cid-vbs6sfrm> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-vbs6sfrm> <polyline points="15 18 9 12 15 6" data-astro-cid-vbs6sfrm></polyline> </svg> </button> <button class="story-nav-btn story-nav-next" aria-label="Next" data-story-next data-astro-cid-vbs6sfrm> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-vbs6sfrm> <polyline points="9 18 15 12 9 6" data-astro-cid-vbs6sfrm></polyline> </svg> </button> <!-- Progress bars --> <div class="story-progress" data-astro-cid-vbs6sfrm> <div class="progress-bar" data-story-progress data-astro-cid-vbs6sfrm></div> </div> </div> </div> <script>\n    (function () {\n        class WebStoryViewer {\n            constructor() {\n                this.viewer = document.getElementById("web-story-viewer");\n                this.content = this.viewer?.querySelector(\n                    "[data-story-content]",\n                );\n                this.closeBtn = this.viewer?.querySelector(".story-close");\n                this.prevBtn = this.viewer?.querySelector("[data-story-prev]");\n                this.nextBtn = this.viewer?.querySelector("[data-story-next]");\n\n                this.currentStory = null;\n                this.currentPage = 0;\n\n                console.log("WebStoryViewer initialized");\n                this.init();\n            }\n\n            init() {\n                if (!this.viewer) return;\n\n                this.closeBtn?.addEventListener("click", () => this.close());\n                this.prevBtn?.addEventListener("click", (e) => {\n                    e.stopPropagation();\n                    this.previousPage();\n                });\n                this.nextBtn?.addEventListener("click", (e) => {\n                    e.stopPropagation();\n                    this.nextPage();\n                });\n\n                document.addEventListener("keydown", (e) => {\n                    if (!this.viewer?.classList.contains("active")) return;\n                    if (e.key === "ArrowLeft") this.previousPage();\n                    if (e.key === "ArrowRight") this.nextPage();\n                    if (e.key === "Escape") this.close();\n                });\n\n                let touchStartX = 0;\n                this.viewer.addEventListener("touchstart", (e) => {\n                    touchStartX = e.changedTouches[0].screenX;\n                });\n                this.viewer.addEventListener("touchend", (e) => {\n                    const diff = touchStartX - e.changedTouches[0].screenX;\n                    if (Math.abs(diff) > 50) {\n                        diff > 0 ? this.nextPage() : this.previousPage();\n                    }\n                });\n            }\n\n            open(story, pages) {\n                console.log("=== OPENING STORY ===");\n                console.log("Story object:", JSON.stringify(story));\n                console.log("Pages array:", JSON.stringify(pages));\n\n                this.currentStory = story;\n                this.currentPage = 0;\n                this.renderPages(pages);\n                this.viewer?.classList.add("active");\n                document.body.style.overflow = "hidden";\n                this.showPage(0);\n            }\n\n            close() {\n                // Clear auto-advance timer\n                if (this.autoAdvanceTimer) {\n                    clearTimeout(this.autoAdvanceTimer);\n                    this.autoAdvanceTimer = null;\n                }\n                this.viewer?.classList.remove("active");\n                document.body.style.overflow = "";\n                this.currentStory = null;\n                this.currentPage = 0;\n            }\n\n            renderPages(pages) {\n                if (!this.content) {\n                    console.error("Content element not found!");\n                    return;\n                }\n\n                console.log("Rendering", pages.length, "pages");\n\n                // Render progress bars with INLINE styles for visibility\n                const progressContainer =\n                    this.viewer?.querySelector(".story-progress");\n                if (progressContainer) {\n                    // Force container styles\n                    progressContainer.style.cssText =\n                        "position:absolute;top:20px;left:16px;right:60px;display:flex;gap:8px;z-index:99999;pointer-events:none;";\n\n                    progressContainer.innerHTML = pages\n                        .map(\n                            (_, i) => `\n                            <div class="progress-bar" style="flex:1;height:6px;background:#555;border-radius:3px;overflow:hidden;">\n                                <div class="progress-fill" data-progress="${i}" style="height:100%;width:0%;background:#ff6600;transition:width 5s linear;"></div>\n                            </div>\n                        `,\n                        )\n                        .join("");\n                    console.log(\n                        "Progress bars rendered with inline styles:",\n                        pages.length,\n                    );\n                }\n\n                // IMPORTANT: Capture story reference before map\n                const storyData = this.currentStory;\n                const numPages = pages.length;\n\n                console.log("Story data for CTA:", storyData);\n\n                // Build pages HTML with INLINE STYLES\n                let pagesHtml = "";\n                for (let i = 0; i < pages.length; i++) {\n                    const page = pages[i];\n                    const isLastPage = i === numPages - 1;\n\n                    console.log(\n                        `Building page ${i}: title="${page.title}", text="${page.text}", isLast=${isLastPage}`,\n                    );\n\n                    let ctaHtml = "";\n                    if (isLastPage && storyData) {\n                        const href =\n                            storyData.route || "/recipes/" + storyData.slug;\n                        console.log("Adding CTA with href:", href);\n                        ctaHtml = `\n                            <a href="${href}" style="display:inline-flex;align-items:center;gap:10px;background:linear-gradient(135deg,#ff6600,#ff8800);color:#fff;padding:16px 28px;border-radius:50px;text-decoration:none;font-weight:700;font-size:17px;box-shadow:0 4px 15px rgba(255,102,0,0.4);margin-top:16px;z-index:99999;position:relative;">\n                                Read Full Recipe\n                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                                    <path d="M5 12h14M12 5l7 7-7 7"/>\n                                </svg>\n                            </a>\n                        `;\n                    }\n\n                    const imageUrl = page.imageUrl || "";\n                    const imageAlt = page.imageAlt || "";\n                    const title = page.title || "";\n                    const text = page.text || "";\n\n                    // Overlay with inline gradient\n                    const overlayStyle =\n                        "position:absolute;inset:0;background:linear-gradient(to bottom,rgba(0,0,0,0.5) 0%,transparent 25%,transparent 50%,rgba(0,0,0,0.9) 100%);display:flex;flex-direction:column;justify-content:flex-end;padding:60px 24px 40px;color:#fff;z-index:10;";\n\n                    // Title style\n                    const titleStyle =\n                        "font-size:26px;font-weight:700;margin:0 0 12px;line-height:1.3;text-shadow:0 2px 4px rgba(0,0,0,0.8);color:#fff;";\n\n                    // Text style\n                    const textStyle =\n                        "font-size:16px;line-height:1.5;margin:0 0 20px;text-shadow:0 1px 3px rgba(0,0,0,0.8);color:#fff;opacity:0.95;";\n\n                    pagesHtml += `\n                        <div class="story-page" data-page="${i}" style="position:absolute;inset:0;opacity:0;visibility:hidden;">\n                            <div style="position:absolute;inset:0;">\n                                <img src="${imageUrl}" alt="${imageAlt}" style="width:100%;height:100%;object-fit:cover;" />\n                            </div>\n                            <div style="${overlayStyle}">\n                                <h2 style="${titleStyle}">${title}</h2>\n                                <p style="${textStyle}">${text}</p>\n                                ${ctaHtml}\n                            </div>\n                        </div>\n                    `;\n                }\n\n                this.content.innerHTML = pagesHtml;\n                console.log("Pages HTML injected into content");\n            }\n\n            showPage(index) {\n                const pages = this.content?.querySelectorAll(".story-page");\n                if (!pages || index < 0 || index >= pages.length) return;\n\n                // Hide all pages with inline styles\n                pages.forEach((p) => {\n                    p.style.opacity = "0";\n                    p.style.visibility = "hidden";\n                });\n\n                // Show current page with inline styles\n                pages[index].style.opacity = "1";\n                pages[index].style.visibility = "visible";\n\n                this.updateProgress(index, pages.length);\n                this.currentPage = index;\n                console.log("Showing page", index);\n            }\n\n            updateProgress(current, total) {\n                // Clear any existing auto-advance timer\n                if (this.autoAdvanceTimer) {\n                    clearTimeout(this.autoAdvanceTimer);\n                }\n\n                const fills = this.viewer?.querySelectorAll("[data-progress]");\n                fills?.forEach((fill, i) => {\n                    if (i < current) {\n                        // Previous bars: immediately full (no transition)\n                        fill.style.transition = "none";\n                        fill.style.width = "100%";\n                    } else if (i === current) {\n                        // Current bar: start empty, then fill with 10s animation\n                        fill.style.transition = "none";\n                        fill.style.width = "0%";\n                        // Force reflow then animate\n                        fill.offsetHeight;\n                        fill.style.transition = "width 10s linear";\n                        setTimeout(() => {\n                            fill.style.width = "100%";\n                        }, 10);\n                    } else {\n                        // Future bars: empty (no transition)\n                        fill.style.transition = "none";\n                        fill.style.width = "0%";\n                    }\n                });\n\n                // Auto-advance after 10 seconds\n                this.autoAdvanceTimer = setTimeout(() => {\n                    const totalPages =\n                        this.content?.querySelectorAll(".story-page").length ||\n                        0;\n                    if (this.currentPage < totalPages - 1) {\n                        // Go to next page\n                        this.showPage(this.currentPage + 1);\n                    } else {\n                        // Last page - close the viewer\n                        this.close();\n                    }\n                }, 10000);\n            }\n\n            nextPage() {\n                const totalPages =\n                    this.content?.querySelectorAll(".story-page").length || 0;\n                if (this.currentPage < totalPages - 1) {\n                    this.showPage(this.currentPage + 1);\n                }\n            }\n\n            previousPage() {\n                if (this.currentPage > 0) {\n                    this.showPage(this.currentPage - 1);\n                }\n            }\n        }\n\n        const storyViewer = new WebStoryViewer();\n        window.openWebStory = function (story, pages) {\n            storyViewer.open(story, pages);\n        };\n    })();\n<\/script> '], ["", '<div id="web-story-viewer" class="story-viewer" data-astro-cid-vbs6sfrm> <div class="story-container" data-astro-cid-vbs6sfrm> <!-- Close button --> <button class="story-close" aria-label="Close story" data-astro-cid-vbs6sfrm> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-vbs6sfrm> <line x1="18" y1="6" x2="6" y2="18" data-astro-cid-vbs6sfrm></line> <line x1="6" y1="6" x2="18" y2="18" data-astro-cid-vbs6sfrm></line> </svg> </button> <!-- Story content container --> <div class="story-content" data-story-content data-astro-cid-vbs6sfrm> <!-- Pages will be injected here by client script --> </div> <!-- Navigation Buttons --> <button class="story-nav-btn story-nav-prev" aria-label="Previous" data-story-prev data-astro-cid-vbs6sfrm> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-vbs6sfrm> <polyline points="15 18 9 12 15 6" data-astro-cid-vbs6sfrm></polyline> </svg> </button> <button class="story-nav-btn story-nav-next" aria-label="Next" data-story-next data-astro-cid-vbs6sfrm> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-vbs6sfrm> <polyline points="9 18 15 12 9 6" data-astro-cid-vbs6sfrm></polyline> </svg> </button> <!-- Progress bars --> <div class="story-progress" data-astro-cid-vbs6sfrm> <div class="progress-bar" data-story-progress data-astro-cid-vbs6sfrm></div> </div> </div> </div> <script>\n    (function () {\n        class WebStoryViewer {\n            constructor() {\n                this.viewer = document.getElementById("web-story-viewer");\n                this.content = this.viewer?.querySelector(\n                    "[data-story-content]",\n                );\n                this.closeBtn = this.viewer?.querySelector(".story-close");\n                this.prevBtn = this.viewer?.querySelector("[data-story-prev]");\n                this.nextBtn = this.viewer?.querySelector("[data-story-next]");\n\n                this.currentStory = null;\n                this.currentPage = 0;\n\n                console.log("WebStoryViewer initialized");\n                this.init();\n            }\n\n            init() {\n                if (!this.viewer) return;\n\n                this.closeBtn?.addEventListener("click", () => this.close());\n                this.prevBtn?.addEventListener("click", (e) => {\n                    e.stopPropagation();\n                    this.previousPage();\n                });\n                this.nextBtn?.addEventListener("click", (e) => {\n                    e.stopPropagation();\n                    this.nextPage();\n                });\n\n                document.addEventListener("keydown", (e) => {\n                    if (!this.viewer?.classList.contains("active")) return;\n                    if (e.key === "ArrowLeft") this.previousPage();\n                    if (e.key === "ArrowRight") this.nextPage();\n                    if (e.key === "Escape") this.close();\n                });\n\n                let touchStartX = 0;\n                this.viewer.addEventListener("touchstart", (e) => {\n                    touchStartX = e.changedTouches[0].screenX;\n                });\n                this.viewer.addEventListener("touchend", (e) => {\n                    const diff = touchStartX - e.changedTouches[0].screenX;\n                    if (Math.abs(diff) > 50) {\n                        diff > 0 ? this.nextPage() : this.previousPage();\n                    }\n                });\n            }\n\n            open(story, pages) {\n                console.log("=== OPENING STORY ===");\n                console.log("Story object:", JSON.stringify(story));\n                console.log("Pages array:", JSON.stringify(pages));\n\n                this.currentStory = story;\n                this.currentPage = 0;\n                this.renderPages(pages);\n                this.viewer?.classList.add("active");\n                document.body.style.overflow = "hidden";\n                this.showPage(0);\n            }\n\n            close() {\n                // Clear auto-advance timer\n                if (this.autoAdvanceTimer) {\n                    clearTimeout(this.autoAdvanceTimer);\n                    this.autoAdvanceTimer = null;\n                }\n                this.viewer?.classList.remove("active");\n                document.body.style.overflow = "";\n                this.currentStory = null;\n                this.currentPage = 0;\n            }\n\n            renderPages(pages) {\n                if (!this.content) {\n                    console.error("Content element not found!");\n                    return;\n                }\n\n                console.log("Rendering", pages.length, "pages");\n\n                // Render progress bars with INLINE styles for visibility\n                const progressContainer =\n                    this.viewer?.querySelector(".story-progress");\n                if (progressContainer) {\n                    // Force container styles\n                    progressContainer.style.cssText =\n                        "position:absolute;top:20px;left:16px;right:60px;display:flex;gap:8px;z-index:99999;pointer-events:none;";\n\n                    progressContainer.innerHTML = pages\n                        .map(\n                            (_, i) => \\`\n                            <div class="progress-bar" style="flex:1;height:6px;background:#555;border-radius:3px;overflow:hidden;">\n                                <div class="progress-fill" data-progress="\\${i}" style="height:100%;width:0%;background:#ff6600;transition:width 5s linear;"></div>\n                            </div>\n                        \\`,\n                        )\n                        .join("");\n                    console.log(\n                        "Progress bars rendered with inline styles:",\n                        pages.length,\n                    );\n                }\n\n                // IMPORTANT: Capture story reference before map\n                const storyData = this.currentStory;\n                const numPages = pages.length;\n\n                console.log("Story data for CTA:", storyData);\n\n                // Build pages HTML with INLINE STYLES\n                let pagesHtml = "";\n                for (let i = 0; i < pages.length; i++) {\n                    const page = pages[i];\n                    const isLastPage = i === numPages - 1;\n\n                    console.log(\n                        \\`Building page \\${i}: title="\\${page.title}", text="\\${page.text}", isLast=\\${isLastPage}\\`,\n                    );\n\n                    let ctaHtml = "";\n                    if (isLastPage && storyData) {\n                        const href =\n                            storyData.route || "/recipes/" + storyData.slug;\n                        console.log("Adding CTA with href:", href);\n                        ctaHtml = \\`\n                            <a href="\\${href}" style="display:inline-flex;align-items:center;gap:10px;background:linear-gradient(135deg,#ff6600,#ff8800);color:#fff;padding:16px 28px;border-radius:50px;text-decoration:none;font-weight:700;font-size:17px;box-shadow:0 4px 15px rgba(255,102,0,0.4);margin-top:16px;z-index:99999;position:relative;">\n                                Read Full Recipe\n                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                                    <path d="M5 12h14M12 5l7 7-7 7"/>\n                                </svg>\n                            </a>\n                        \\`;\n                    }\n\n                    const imageUrl = page.imageUrl || "";\n                    const imageAlt = page.imageAlt || "";\n                    const title = page.title || "";\n                    const text = page.text || "";\n\n                    // Overlay with inline gradient\n                    const overlayStyle =\n                        "position:absolute;inset:0;background:linear-gradient(to bottom,rgba(0,0,0,0.5) 0%,transparent 25%,transparent 50%,rgba(0,0,0,0.9) 100%);display:flex;flex-direction:column;justify-content:flex-end;padding:60px 24px 40px;color:#fff;z-index:10;";\n\n                    // Title style\n                    const titleStyle =\n                        "font-size:26px;font-weight:700;margin:0 0 12px;line-height:1.3;text-shadow:0 2px 4px rgba(0,0,0,0.8);color:#fff;";\n\n                    // Text style\n                    const textStyle =\n                        "font-size:16px;line-height:1.5;margin:0 0 20px;text-shadow:0 1px 3px rgba(0,0,0,0.8);color:#fff;opacity:0.95;";\n\n                    pagesHtml += \\`\n                        <div class="story-page" data-page="\\${i}" style="position:absolute;inset:0;opacity:0;visibility:hidden;">\n                            <div style="position:absolute;inset:0;">\n                                <img src="\\${imageUrl}" alt="\\${imageAlt}" style="width:100%;height:100%;object-fit:cover;" />\n                            </div>\n                            <div style="\\${overlayStyle}">\n                                <h2 style="\\${titleStyle}">\\${title}</h2>\n                                <p style="\\${textStyle}">\\${text}</p>\n                                \\${ctaHtml}\n                            </div>\n                        </div>\n                    \\`;\n                }\n\n                this.content.innerHTML = pagesHtml;\n                console.log("Pages HTML injected into content");\n            }\n\n            showPage(index) {\n                const pages = this.content?.querySelectorAll(".story-page");\n                if (!pages || index < 0 || index >= pages.length) return;\n\n                // Hide all pages with inline styles\n                pages.forEach((p) => {\n                    p.style.opacity = "0";\n                    p.style.visibility = "hidden";\n                });\n\n                // Show current page with inline styles\n                pages[index].style.opacity = "1";\n                pages[index].style.visibility = "visible";\n\n                this.updateProgress(index, pages.length);\n                this.currentPage = index;\n                console.log("Showing page", index);\n            }\n\n            updateProgress(current, total) {\n                // Clear any existing auto-advance timer\n                if (this.autoAdvanceTimer) {\n                    clearTimeout(this.autoAdvanceTimer);\n                }\n\n                const fills = this.viewer?.querySelectorAll("[data-progress]");\n                fills?.forEach((fill, i) => {\n                    if (i < current) {\n                        // Previous bars: immediately full (no transition)\n                        fill.style.transition = "none";\n                        fill.style.width = "100%";\n                    } else if (i === current) {\n                        // Current bar: start empty, then fill with 10s animation\n                        fill.style.transition = "none";\n                        fill.style.width = "0%";\n                        // Force reflow then animate\n                        fill.offsetHeight;\n                        fill.style.transition = "width 10s linear";\n                        setTimeout(() => {\n                            fill.style.width = "100%";\n                        }, 10);\n                    } else {\n                        // Future bars: empty (no transition)\n                        fill.style.transition = "none";\n                        fill.style.width = "0%";\n                    }\n                });\n\n                // Auto-advance after 10 seconds\n                this.autoAdvanceTimer = setTimeout(() => {\n                    const totalPages =\n                        this.content?.querySelectorAll(".story-page").length ||\n                        0;\n                    if (this.currentPage < totalPages - 1) {\n                        // Go to next page\n                        this.showPage(this.currentPage + 1);\n                    } else {\n                        // Last page - close the viewer\n                        this.close();\n                    }\n                }, 10000);\n            }\n\n            nextPage() {\n                const totalPages =\n                    this.content?.querySelectorAll(".story-page").length || 0;\n                if (this.currentPage < totalPages - 1) {\n                    this.showPage(this.currentPage + 1);\n                }\n            }\n\n            previousPage() {\n                if (this.currentPage > 0) {\n                    this.showPage(this.currentPage - 1);\n                }\n            }\n        }\n\n        const storyViewer = new WebStoryViewer();\n        window.openWebStory = function (story, pages) {\n            storyViewer.open(story, pages);\n        };\n    })();\n<\/script> '])), maybeRenderHead());
}, "C:/Users/Poste/Desktop/SaaS Astro/freecipies-blog/src/components/WebStoryViewer.astro", void 0);

const $$Astro = createAstro("https://localhost:4321");
const $$Index = createComponent(async ($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro, $$props, $$slots);
  Astro2.self = $$Index;
  const { env } = Astro2.locals.runtime;
  const siteTitle = "Easy and Quick Recipes for Everyone - Freecipies";
  const siteDescription = "Discover delicious, easy-to-follow recipes with everyday ingredients. From quick weeknight dinners to impressive desserts, Freecipies makes cooking fun and accessible!";
  let allRecipes = [];
  let categories = [];
  try {
    const { items: recipes } = await getArticles(env.DB, { limit: 12 });
    allRecipes = recipes.map(hydrateArticle);
    const rawCategories = await getCategories(env.DB, { isOnline: true });
    categories = rawCategories.map(hydrateCategory);
  } catch (error) {
    console.error("Error fetching data for homepage:", error);
  }
  const featuredRecipes = allRecipes.slice(0, 4);
  const popularRecipes = allRecipes.slice(0, 4);
  const moreRecipes = allRecipes.slice(4, 8);
  const categoryColorMap = new Map(categories.map((c) => [c.slug, c.color || "#ff6600"]));
  const getRecipeUrl = (recipe) => recipe.route || `/recipes/${recipe.slug}`;
  const getCategoryColor = (categorySlug) => categoryColorMap.get(categorySlug) || "#ff6600";
  const getRecipeImage = (recipe, targetWidth, prefer = "cover") => {
    const cover = extractImage(recipe.imagesJson, "cover", targetWidth);
    const thumbnail = extractImage(recipe.imagesJson, "thumbnail", targetWidth);
    const slotName = prefer === "cover" ? cover.imageUrl ? "cover" : "thumbnail" : thumbnail.imageUrl ? "thumbnail" : "cover";
    const selected = slotName === "cover" ? cover : thumbnail;
    const srcSet = getImageSrcSet(recipe.imagesJson, slotName);
    return { selected, srcSet };
  };
  const getCategoryImage = (category, targetWidth, prefer = "thumbnail") => {
    const cover = extractImage(category.imagesJson, "cover", targetWidth);
    const thumbnail = extractImage(category.imagesJson, "thumbnail", targetWidth);
    const slotName = prefer === "cover" ? cover.imageUrl ? "cover" : "thumbnail" : thumbnail.imageUrl ? "thumbnail" : "cover";
    const selected = slotName === "cover" ? cover : thumbnail;
    const srcSet = getImageSrcSet(category.imagesJson, slotName);
    return { selected, srcSet };
  };
  return renderTemplate`${renderComponent($$result, "Layout", $$Layout, { "title": siteTitle, "description": siteDescription, "data-astro-cid-j7pv25f6": true }, { "default": async ($$result2) => renderTemplate` ${maybeRenderHead()}<main class="homepage" data-astro-cid-j7pv25f6> ${renderComponent($$result2, "StoriesBar", $$StoriesBar, { "data-astro-cid-j7pv25f6": true })} ${featuredRecipes.length > 0 && renderTemplate`<section class="hero-grid-section" data-astro-cid-j7pv25f6> <div class="hero-grid" data-astro-cid-j7pv25f6>  <div class="hero-slider" id="heroSlider" data-astro-cid-j7pv25f6> <div class="slider-track" data-astro-cid-j7pv25f6> ${featuredRecipes.slice(0, 4).map((recipe, index) => {
    const { selected, srcSet } = getRecipeImage(recipe, 1200, "cover");
    const sizes = "(max-width: 900px) 100vw, 60vw";
    return renderTemplate`<a${addAttribute(getRecipeUrl(recipe), "href")}${addAttribute(["slide", { active: index === 0 }], "class:list")}${addAttribute(index, "data-index")} data-astro-cid-j7pv25f6> <div class="card-image" data-astro-cid-j7pv25f6> ${(selected.imageUrl || recipe.imageUrl) && renderTemplate`<img${addAttribute(selected.imageUrl || recipe.imageUrl, "src")}${addAttribute(selected.imageAlt || recipe.imageAlt || recipe.headline, "alt")}${addAttribute(selected.imageWidth || recipe.imageWidth || 1200, "width")}${addAttribute(selected.imageHeight || recipe.imageHeight || 675, "height")}${addAttribute(srcSet || void 0, "srcset")}${addAttribute(srcSet ? sizes : void 0, "sizes")}${addAttribute(index === 0 ? "eager" : "lazy", "loading")}${addAttribute(index === 0 ? "high" : "auto", "fetchpriority")} data-astro-cid-j7pv25f6>`} <div class="card-overlay" data-astro-cid-j7pv25f6></div> </div> <div class="card-content" data-astro-cid-j7pv25f6> <span class="card-category"${addAttribute(`--badge-color: ${getCategoryColor(recipe.categorySlug)};`, "style")} data-astro-cid-j7pv25f6> ${recipe.categoryLabel} </span> <h2 class="card-title" data-astro-cid-j7pv25f6>${recipe.headline}</h2> </div> </a>`;
  })} </div>  <div class="slider-dots" data-astro-cid-j7pv25f6> ${featuredRecipes.slice(0, 4).map((_, index) => renderTemplate`<button${addAttribute(["dot", { active: index === 0 }], "class:list")}${addAttribute(index, "data-index")}${addAttribute(`Slide ${index + 1}`, "aria-label")} data-astro-cid-j7pv25f6></button>`)} </div> </div>  <div class="hero-side-cards" data-astro-cid-j7pv25f6> ${featuredRecipes.slice(1, 3).map((recipe) => {
    const { selected, srcSet } = getRecipeImage(recipe, 600, "cover");
    const sizes = "(max-width: 900px) 100vw, 40vw";
    return renderTemplate`<a${addAttribute(getRecipeUrl(recipe), "href")} class="recipe-card recipe-card-small" data-astro-cid-j7pv25f6> <div class="card-image" data-astro-cid-j7pv25f6> ${(selected.imageUrl || recipe.imageUrl) && renderTemplate`<img${addAttribute(selected.imageUrl || recipe.imageUrl, "src")}${addAttribute(selected.imageAlt || recipe.imageAlt || recipe.headline, "alt")}${addAttribute(selected.imageWidth || recipe.imageWidth || 600, "width")}${addAttribute(selected.imageHeight || recipe.imageHeight || 400, "height")}${addAttribute(srcSet || void 0, "srcset")}${addAttribute(srcSet ? sizes : void 0, "sizes")} loading="lazy" data-astro-cid-j7pv25f6>`} <div class="card-overlay" data-astro-cid-j7pv25f6></div> </div> <div class="card-content" data-astro-cid-j7pv25f6> <span class="card-category"${addAttribute(`--badge-color: ${getCategoryColor(recipe.categorySlug)};`, "style")} data-astro-cid-j7pv25f6>${recipe.categoryLabel}</span> <h3 class="card-title" data-astro-cid-j7pv25f6>${recipe.headline}</h3> </div> </a>`;
  })} </div> </div> </section>`} <!-- Popular Recipes Section --> ${popularRecipes.length > 0 && renderTemplate`<section class="section popular-recipes-section" data-astro-cid-j7pv25f6> <div class="container" data-astro-cid-j7pv25f6> <div class="section-header" data-astro-cid-j7pv25f6> <h2 class="section-title" data-astro-cid-j7pv25f6> <span class="title-dot" data-astro-cid-j7pv25f6></span>
Popular Recipes
</h2> </div> <div class="popular-grid" data-astro-cid-j7pv25f6> ${popularRecipes.map((recipe) => {
    const { selected, srcSet } = getRecipeImage(recipe, 400, "cover");
    const sizes = "(max-width: 600px) 100vw, (max-width: 1024px) 50vw, 25vw";
    return renderTemplate`<article class="foxiz-card" data-astro-cid-j7pv25f6> <a${addAttribute(getRecipeUrl(recipe), "href")} class="foxiz-card-image" data-astro-cid-j7pv25f6> ${(selected.imageUrl || recipe.imageUrl) && renderTemplate`<img${addAttribute(selected.imageUrl || recipe.imageUrl, "src")}${addAttribute(selected.imageAlt || recipe.imageAlt || recipe.headline, "alt")}${addAttribute(selected.imageWidth || recipe.imageWidth || 400, "width")}${addAttribute(selected.imageHeight || recipe.imageHeight || 300, "height")}${addAttribute(srcSet || void 0, "srcset")}${addAttribute(srcSet ? sizes : void 0, "sizes")} loading="lazy" data-astro-cid-j7pv25f6>`} <span class="foxiz-badge"${addAttribute(`--badge-color: ${getCategoryColor(recipe.categorySlug)};`, "style")} data-astro-cid-j7pv25f6> ${recipe.categoryLabel} </span> </a> <div class="foxiz-card-body" data-astro-cid-j7pv25f6> <h3 class="foxiz-card-title" data-astro-cid-j7pv25f6> <a${addAttribute(getRecipeUrl(recipe), "href")} data-astro-cid-j7pv25f6>${recipe.headline}</a> </h3> <div class="foxiz-tags" data-astro-cid-j7pv25f6> ${recipe.categoryLabel && renderTemplate`<a${addAttribute(`/categories/${recipe.categorySlug}`, "href")} class="foxiz-tag" data-astro-cid-j7pv25f6> <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-j7pv25f6> <path d="M4 4h6l2 3h8v10H4z" data-astro-cid-j7pv25f6></path> </svg> ${recipe.categoryLabel} </a>`} ${recipe.recipeJson?.cookTime && renderTemplate`<span class="foxiz-tag" data-astro-cid-j7pv25f6> <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-j7pv25f6> <circle cx="12" cy="12" r="10" data-astro-cid-j7pv25f6></circle> <path d="M12 6v6l4 2" data-astro-cid-j7pv25f6></path> </svg> ${recipe.recipeJson.cookTime} </span>`} </div> </div> </article>`;
  })} </div> </div> </section>`} <!-- Want to Learn How to Make Section --> ${categories.length > 0 && renderTemplate`<section class="section categories-section" data-astro-cid-j7pv25f6> <div class="container" data-astro-cid-j7pv25f6> <h2 class="section-title centered" data-astro-cid-j7pv25f6>Want to Learn How to Make?</h2> <!-- Category Filter Buttons --> <div class="category-filter-row" data-astro-cid-j7pv25f6> ${categories.slice(0, 4).map((category) => renderTemplate`<a${addAttribute(`/categories/${category.slug}`, "href")} class="category-filter-btn" data-astro-cid-j7pv25f6> ${category.label} </a>`)} </div> <!-- Category Chips with Images --> <div class="category-chips-row" data-astro-cid-j7pv25f6> ${categories.map((category) => {
    const { selected, srcSet } = getCategoryImage(category, 80, "thumbnail");
    const sizes = "80px";
    return renderTemplate`<a${addAttribute(`/categories/${category.slug}`, "href")} class="category-chip" data-astro-cid-j7pv25f6> <div class="chip-image-wrapper" data-astro-cid-j7pv25f6> ${selected.imageUrl || category.imageUrl ? renderTemplate`<img${addAttribute(selected.imageUrl || category.imageUrl, "src")}${addAttribute(selected.imageAlt || category.imageAlt || category.label, "alt")}${addAttribute(selected.imageWidth || category.imageWidth || 80, "width")}${addAttribute(selected.imageHeight || category.imageHeight || 80, "height")}${addAttribute(srcSet || void 0, "srcset")}${addAttribute(srcSet ? sizes : void 0, "sizes")} loading="lazy" data-astro-cid-j7pv25f6>` : renderTemplate`<div class="chip-placeholder" data-astro-cid-j7pv25f6> ${category.label.charAt(0)} </div>`} </div> <span class="chip-label" data-astro-cid-j7pv25f6>${category.label}</span> <span class="chip-type" data-astro-cid-j7pv25f6>Category</span> </a>`;
  })} </div> </div> </section>`} <!-- More Recipes Section --> ${moreRecipes.length > 0 && renderTemplate`<section class="section more-recipes-section" data-astro-cid-j7pv25f6> <div class="container" data-astro-cid-j7pv25f6> <div class="section-header" data-astro-cid-j7pv25f6> <h2 class="section-title" data-astro-cid-j7pv25f6> <span class="title-dot" data-astro-cid-j7pv25f6></span>
More Recipes
</h2> <a href="/recipes" class="view-all" data-astro-cid-j7pv25f6>
View All â†’
</a> </div> <div class="recipes-grid" data-astro-cid-j7pv25f6> ${moreRecipes.map((recipe) => {
    const { selected, srcSet } = getRecipeImage(recipe, 400, "cover");
    const sizes = "(max-width: 768px) 50vw, 25vw";
    return renderTemplate`<a${addAttribute(getRecipeUrl(recipe), "href")} class="recipe-card-vertical" data-astro-cid-j7pv25f6> <div class="card-image-wrapper" data-astro-cid-j7pv25f6> ${(selected.imageUrl || recipe.imageUrl) && renderTemplate`<img${addAttribute(selected.imageUrl || recipe.imageUrl, "src")}${addAttribute(selected.imageAlt || recipe.imageAlt || recipe.headline, "alt")}${addAttribute(selected.imageWidth || recipe.imageWidth || 400, "width")}${addAttribute(selected.imageHeight || recipe.imageHeight || 300, "height")}${addAttribute(srcSet || void 0, "srcset")}${addAttribute(srcSet ? sizes : void 0, "sizes")} loading="lazy" data-astro-cid-j7pv25f6>`} <span class="card-category-badge"${addAttribute(`--badge-color: ${getCategoryColor(recipe.categorySlug)};`, "style")} data-astro-cid-j7pv25f6> ${recipe.categoryLabel} </span> </div> <div class="card-body" data-astro-cid-j7pv25f6> <h3 class="card-title" data-astro-cid-j7pv25f6>${recipe.headline}</h3> <div class="card-meta" data-astro-cid-j7pv25f6> ${recipe.recipeJson?.prepTime && renderTemplate`<span class="meta-item" data-astro-cid-j7pv25f6> <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-j7pv25f6> <circle cx="12" cy="12" r="10" data-astro-cid-j7pv25f6></circle> <path d="M12 6v6l4 2" data-astro-cid-j7pv25f6></path> </svg> ${recipe.recipeJson.prepTime} </span>`} </div> </div> </a>`;
  })} </div> </div> </section>`} <!-- Newsletter Banner --> <section class="newsletter-banner" data-astro-cid-j7pv25f6> <div class="container" data-astro-cid-j7pv25f6> <div class="newsletter-content" data-astro-cid-j7pv25f6> <h2 data-astro-cid-j7pv25f6>Get New Recipes Weekly</h2> <p data-astro-cid-j7pv25f6>Subscribe to receive delicious recipes straight to your inbox.</p> <form class="newsletter-form" data-astro-cid-j7pv25f6> <input type="email" placeholder="Your email address" required data-astro-cid-j7pv25f6> <button type="submit" data-astro-cid-j7pv25f6>Subscribe</button> </form> </div> </div> </section> </main> ${renderComponent($$result2, "WebStoryViewer", $$WebStoryViewer, { "data-astro-cid-j7pv25f6": true })} ` })}  ${renderScript($$result, "C:/Users/Poste/Desktop/SaaS Astro/freecipies-blog/src/pages/index.astro?astro&type=script&index=0&lang.ts")}`;
}, "C:/Users/Poste/Desktop/SaaS Astro/freecipies-blog/src/pages/index.astro", void 0);

const $$file = "C:/Users/Poste/Desktop/SaaS Astro/freecipies-blog/src/pages/index.astro";
const $$url = "";

const _page = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.defineProperty({
  __proto__: null,
  default: $$Index,
  file: $$file,
  url: $$url
}, Symbol.toStringTag, { value: 'Module' }));

const page = () => _page;

export { page };
